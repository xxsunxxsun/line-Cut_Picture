<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>åœ–ç‰‡è£å‰ªå·¥å…·</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css" rel="stylesheet">
  <style>
    /* å…¨å±€è¨­ç½® */
    body {
      font-family: "Segoe UI", "å¾®è»Ÿæ­£é»‘é«”", Arial, sans-serif; /* èª¿æ•´å­—é«” */
      background-color: #f0f4f8; /* éå¸¸æ·ºçš„è—ç°è‰²èƒŒæ™¯ */
      margin: 0;
      padding: 0 20px 40px 20px; /* èª¿æ•´ paddingï¼Œé ‚éƒ¨ç‚º 0ï¼Œåº•éƒ¨ä¿ç•™ */
      display: flex;
      flex-direction: column;
      align-items: center;
      color: #333; /* é»˜èªæ–‡å­—é¡è‰² */
    }

    /* å°èˆªåˆ—å®¹å™¨ */
    nav {
      width: 100%;
      /* ç§»é™¤èƒŒæ™¯å’Œé™°å½±ï¼Œè®“æŒ‰éˆ•æœ¬èº«å¸¶æœ‰è¦–è¦ºæ•ˆæœ */
      padding: 15px 0; /* å¢åŠ ä¸Šä¸‹ paddingï¼Œçµ¦å°èˆªé€£çµä¸€äº›ç©ºé–“ */
      margin-bottom: 20px; /* èª¿æ•´å°èˆªåˆ—èˆ‡å®¹å™¨çš„é–“è· */
       position: relative; /* ç¢ºä¿ z-index æœ‰æ•ˆ */
       z-index: 10; /* è®“å°èˆªåœ¨æœ€ä¸Šå±¤ */
    }

    /* å°èˆªé€£çµå®¹å™¨ (ç”¨æ–¼å±…ä¸­å’Œæ§åˆ¶æœ€å¤§å¯¬åº¦) */
    nav div {
      max-width: 800px;
      margin: 0 auto;
      display: flex;
      justify-content: center; /* å°èˆªé€£çµå±…ä¸­ */
      padding: 0 20px; /* å°èˆªåˆ—å…§å®¹å·¦å³ padding */
      gap: 20px; /* èª¿æ•´é€£çµä¹‹é–“çš„é–“è· */
      flex-wrap: wrap; /* å…è¨±åœ¨å°å±å¹•æ›è¡Œ */
    }

    /* å°èˆªé€£çµ (æŒ‰éˆ•æ¨£å¼) */
    nav a {
      display: inline-block; /* è®“ padding, margin, width æœ‰æ•ˆ */
      padding: 10px 20px; /* å¢åŠ å…§é‚Šè·ï¼Œå½¢æˆæŒ‰éˆ•å¤§å° */
      border: 2px solid #64b5f6; /* æ·ºè—è‰²é‚Šæ¡† */
      background-color: #e3f2fd; /* éå¸¸æ·ºçš„è—è‰²èƒŒæ™¯ */
      color: #01579b; /* æ·±è—è‰²æ–‡å­— */
      text-decoration: none;
      font-weight: bold;
      font-size: 16px;
      border-radius: 5px; /* åœ“è§’ */
      box-shadow: 0 2px 5px rgba(0,0,0,0.1); /* è¼•å¾®é™°å½± */
      transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease; /* å¹³æ»‘éæ¸¡ */
      text-align: center; /* æ–‡å­—å±…ä¸­ */
      min-width: 120px; /* è¨­ç½®æœ€å°å¯¬åº¦ */
    }
     nav a:hover {
       background-color: #bbdefb; /* æ‡¸åœæ™‚èƒŒæ™¯è®Šæ·± */
       color: #01579b; /* æ–‡å­—é¡è‰²ä¸è®Š */
       border-color: #42a5f5; /* é‚Šæ¡†é¡è‰²è®Šæ·± */
       box-shadow: 0 4px 8px rgba(0,0,0,0.15); /* æ‡¸åœæ™‚é™°å½±è®Šå¤§ */
     }

    /* ä¸»è¦å®¹å™¨ */
    #container {
      background: #ffffff; /* ç™½è‰²èƒŒæ™¯ */
      padding: 25px; /* èª¿æ•´ padding */
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.1); /* æ›´æ˜é¡¯ä¸€é»çš„é™°å½± */
      max-width: 800px;
      width: 100%;
      box-sizing: border-box; /* ç¢ºä¿ padding ä¸å½±éŸ¿å¯¬åº¦ */
      /* margin-top: 20px; /* å¦‚æœ nav margin-bottom ä¸å¤ ï¼Œå¯ä»¥åœ¨é€™è£¡åŠ  */ */
    }

    /* æ¨™é ­å€å¡Š */
    #header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px; /* å¢åŠ åº•éƒ¨é–“è· */
      flex-wrap: wrap; /* å…è¨±æ›è¡Œåœ¨å°å±å¹• */
    }

    /* è²¼åœ–æ•¸é‡é¡¯ç¤º */
    #countDisplay {
      padding: 8px 12px; /* èª¿æ•´ padding */
      background-color: #e1f5fe; /* éå¸¸æ·ºçš„è—è‰²èƒŒæ™¯ */
      color: #01579b; /* æ·±è—è‰²æ–‡å­— */
      border-radius: 5px;
      font-weight: bold;
      font-size: 15px;
      border: 1px solid #b3e5fc; /* æ·ºè—è‰²é‚Šæ¡† */
      margin-top: 10px; /* åœ¨å°å±å¹•æ›è¡Œæ™‚çš„é–“è· */
    }

    /* æª”æ¡ˆä¸Šå‚³æŒ‰éˆ• */
    #upload {
      padding: 10px;
      border: 2px solid #ccc; /* æ·ºç°è‰²é‚Šæ¡† */
      border-radius: 5px;
      font-size: 18px; /* èª¿æ•´å­—é«”å¤§å° */
      background-color: #fff; /* ç™½è‰²èƒŒæ™¯ */
      cursor: pointer;
      width: 100%; /* è®“è¼¸å…¥æ¡†ä½”æ»¿å¯¬åº¦ */
      box-sizing: border-box;
    }

    /* é¡¯ç¤ºåœ–ç‰‡ */
    img {
      max-width: 100%;
      height: auto; /* ä¿æŒæ¯”ä¾‹ */
      display: block; /* é˜²æ­¢ä¸‹æ–¹æœ‰ç©ºç™½é–“éš™ */
      margin: 20px auto; /* åœ–ç‰‡å±…ä¸­é¡¯ç¤ºä¸¦å¢åŠ ä¸Šä¸‹é–“è· */
    }

    /* è£å‰ªå¾Œçš„ Canvas */
    canvas {
      border: 1px solid #ddd; /* æ·ºç°è‰²é‚Šæ¡† */
      margin-bottom: 5px; /* Canvas ä¸‹æ–¹èˆ‡æŒ‰éˆ•çš„é–“è· */
    }

    /* ä¸‹è¼‰æŒ‰éˆ• */
    .downloadBtn {
      display: inline-block;
      margin-top: 5px;
      padding: 8px 15px; /* èª¿æ•´ padding */
      background-color: #81c784; /* æŸ”å’Œçš„æ·ºç¶ è‰² */
      color: white;
      text-decoration: none;
      border-radius: 5px;
      font-weight: bold;
      font-size: 14px; /* èª¿æ•´å­—é«”å¤§å° */
      transition: background-color 0.3s ease; /* å¹³æ»‘éæ¸¡ */
      text-align: center; /* æ–‡å­—å±…ä¸­ */
    }
    .downloadBtn:hover {
      background-color: #66bb6a; /* æ‡¸åœæ™‚é¡è‰²ç¨æ·± */
    }

    /* é è¦½å€å¡Š */
    #preview {
      display: flex;
      flex-wrap: wrap;
      gap: 15px; /* èª¿æ•´é–“è· */
      margin-top: 25px; /* èª¿æ•´ä¸Šé‚Šè· */
    }

    /* å–®å€‹é è¦½é …ç›® */
    .preview-block {
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: #ffffff; /* ç™½è‰²èƒŒæ™¯ */
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08); /* è¼•å¾®é™°å½± */
      border: 1px solid #eee; /* éå¸¸æ·ºçš„é‚Šæ¡† */
    }

    /* è£å‰ªæŒ‰éˆ• */
    #cropBtn {
      display: none; /* JS æ§åˆ¶é¡¯ç¤º */
      background-color: #64b5f6; /* æŸ”å’Œçš„æ·ºè—è‰² */
      color: white;
      padding: 12px 30px; /* èª¿æ•´ padding */
      font-size: 18px; /* èª¿æ•´å­—é«”å¤§å° */
      border: none;
      border-radius: 5px;
      font-weight: bold;
      margin-bottom: 20px; /* èª¿æ•´åº•éƒ¨é–“è· */
      cursor: pointer;
      transition: background-color 0.3s ease; /* å¹³æ»‘éæ¸¡ */
    }
    #cropBtn:hover {
      background-color: #42a5f5; /* æ‡¸åœæ™‚é¡è‰²ç¨æ·± */
    }

    /* æ¨™é¡Œæ¨£å¼ */
    #title {
      background: linear-gradient(135deg, #e0f7fa, #fff9c4); /* æ›´æ·ºçš„æ¼¸å±¤ */
      color: #333;
      text-align: center;
      padding: 10px 18px; /* èª¿æ•´ padding */
      border-radius: 10px; /* èª¿æ•´åœ“è§’ */
      font-size: 22px;
      font-weight: bold;
      letter-spacing: 0.8px; /* èª¿æ•´å­—è· */
      box-shadow: 1px 1px 5px rgba(0,0,0,0.1); /* æ›´è¼•çš„é™°å½± */
      margin: 0; /* ç§»é™¤é»˜èª margin */
    }

    /* æ‰‹æ©Ÿé©é… */
    @media (max-width: 600px) {
      body {
        padding: 0 15px 20px 15px; /* æ‰‹æ©Ÿé‚Šè·ï¼Œé ‚éƒ¨ç‚º 0 */
      }
      #container {
        padding: 15px; /* æ‰‹æ©Ÿå®¹å™¨å…§ padding */
      }
      #header {
        flex-direction: column;
        align-items: flex-start;
      }
      #countDisplay {
        margin-top: 15px; /* æ‰‹æ©Ÿä¸Šæ¨™é¡Œä¸‹æ–¹çš„é–“è· */
        margin-left: 0;
      }
      #upload {
        font-size: 16px;
        padding: 8px;
      }
      #cropBtn {
        padding: 10px 20px;
        font-size: 16px;
        width: 100%; /* æŒ‰éˆ•ä½”æ»¿å¯¬åº¦ */
        box-sizing: border-box;
      }
      #title {
        font-size: 20px;
        padding: 8px 15px;
      }
      #preview {
          justify-content: center; /* é è¦½åœ–åœ¨å°å±å¹•å±…ä¸­ */
      }
       .preview-block {
          width: 150px; /* åœ¨å°å±å¹•å›ºå®šé è¦½åœ–å¯¬åº¦ */
          box-sizing: border-box;
       }
       canvas {
           max-width: 100%; /* ç¢ºä¿ canvas ä¸è¶…å‡º block */
           height: auto;
       }
        .downloadBtn {
            width: 100%; /* ä¸‹è¼‰æŒ‰éˆ•ä½”æ»¿ block å¯¬åº¦ */
            box-sizing: border-box;
        }
        nav div {
             gap: 10px; /* æ‰‹æ©Ÿä¸Šæ¸›å°‘é€£çµé–“è· */
        }
         nav a {
             padding: 8px 15px; /* æ‰‹æ©Ÿä¸ŠæŒ‰éˆ•å…§é‚Šè· */
             font-size: 15px; /* æ‰‹æ©Ÿä¸Šå­—é«”å¤§å° */
             min-width: unset; /* ç§»é™¤æœ€å°å¯¬åº¦é™åˆ¶ */
             flex-grow: 1; /* è®“æŒ‰éˆ•å½ˆæ€§å¡«å……ç©ºé–“ */
         }
    }

    /* è£åˆ‡å€ç¸®æ”¾æ»‘å¡Šå®¹å™¨ */
    .slider-container {
      margin-top: 20px; /* èª¿æ•´ä¸Šé‚Šè· */
      margin-bottom: 20px; /* èª¿æ•´ä¸‹é‚Šè· */
      display: flex;
      align-items: center;
      gap: 15px; /* èª¿æ•´é–“è· */
      flex-wrap: wrap; /* å…è¨±æ›è¡Œ */
    }
    .slider-container label {
        font-size: 15px; /* èª¿æ•´å­—é«”å¤§å° */
        color: #555; /* æ·±ç°è‰²æ–‡å­— */
        min-width: 80px; /* ç¢ºä¿ label æœ‰æœ€å°å¯¬åº¦ */
    }
    .slider-container input[type="range"] {
      flex-grow: 1; /* è®“æ»‘å¡Šä½”æ»¿å‰©é¤˜ç©ºé–“ */
      min-width: 150px; /* è¨­ç½®æ»‘å¡Šæœ€å°å¯¬åº¦ */
      -webkit-appearance: none; /* ç§»é™¤é»˜èªæ¨£å¼ */
      appearance: none;
      height: 8px; /* æ»‘å¡Šè»Œé“é«˜åº¦ */
      background: #ddd; /* æ»‘å¡Šè»Œé“èƒŒæ™¯ */
      border-radius: 4px;
      outline: none;
      opacity: 0.7;
      transition: opacity .2s;
    }

    .slider-container input[type="range"]:hover {
      opacity: 1;
    }

    .slider-container input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px; /* æ»‘å¡Šå¤§å° */
      height: 20px;
      background: #64b5f6; /* æ»‘å¡Šé¡è‰² */
      cursor: pointer;
      border-radius: 50%;
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }

    .slider-container input[type="range"]::-moz-range-thumb {
      width: 20px;
      height: 20px;
      background: #64b5f6;
      cursor: pointer;
      border-radius: 50%;
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }


    /* å…¨éƒ¨æ¸…é™¤æŒ‰éˆ• */
    #clearBtn {
      margin-top: 15px; /* èª¿æ•´ä¸Šé‚Šè· */
      margin-bottom: 20px;
      padding: 8px 16px;
      background-color: #e0e0e0; /* æ·ºç°è‰²èƒŒæ™¯ */
      color: #333; /* æ·±ç°è‰²æ–‡å­— */
      border: none;
      border-radius: 5px;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
     #clearBtn:hover {
      background-color: #d5d5d5; /* æ‡¸åœæ™‚é¡è‰²ç¨æ·± */
     }


    /* åº•éƒ¨èªªæ˜å€ */
    div[style*="background-color: #f5f5f5"] { /* ç²¾æº–é¸å–èªªæ˜å€ */
      margin-top: 30px;
      padding: 15px;
      background-color: #f5f5f5; /* æ·ºç°è‰²èƒŒæ™¯ */
      border-radius: 8px;
      color: #333;
      font-size: 15px;
      line-height: 1.6;
      border: 1px solid #eee; /* éå¸¸æ·ºçš„é‚Šæ¡† */
    }
    div[style*="background-color: #f5f5f5"] strong { /* èªªæ˜å€å…§çš„ç²—é«”å­— */
       color: #007bff; /* å¼·èª¿æ–‡å­—é¡è‰² */
    }

    /* åº•éƒ¨é€£çµ */
    a[href*="drive.google.com"] { /* Google Drive é€£çµ */
      display: inline-block;
      margin-top: 20px; /* èª¿æ•´ä¸Šé‚Šè· */
      padding: 10px 20px;
      border: 2px solid #64b5f6; /* æŸ”å’Œçš„æ·ºè—è‰²é‚Šæ¡† */
      border-radius: 5px;
      text-decoration: none;
      color: #007bff; /* æ¨™æº–è—è‰²æ–‡å­— */
      font-family: sans-serif;
      font-size: 16px;
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    a[href*="drive.google.com"]:hover {
        background-color: #64b5f6;
        color: white;
    }

    a[href*="canva.com"] { /* Canva é€£çµ */
      display: inline-block;
      padding: 10px 20px;
      border: 2px solid #81c784; /* æŸ”å’Œçš„æ·ºç¶ è‰²é‚Šæ¡† */
      border-radius: 5px;
      text-decoration: none;
      color: #4CAF50; /* æ¨™æº–ç¶ è‰²æ–‡å­— */
      font-family: sans-serif;
      font-size: 16px;
      margin-top: 10px;
      transition: background-color 0.3s ease, color 0.3s ease;
    }
     a[href*="canva.com"]:hover {
        background-color: #81c784;
        color: white;
    }


  </style>
</head>
<body>
  <nav>
    <div>
      <a href="./index.html">ğŸ  ä¸»é </a>
      <a href="./cropper.html">ğŸ“‘Main & Tab åˆ‡å‰²</a>
    </div>
  </nav>

  <div id="container">
    <div id="header">
      <h2 id="title">ğŸ¨ LINE è²¼åœ–è£å‰ªå·¥å…· âœ‚ï¸</h2>
      <div id="countDisplay">ç›®å‰è£åˆ‡å¼µæ•¸ï¼š0</div>
    </div>
    <input type="file" id="upload" accept="image/*">
    <br>
    <div style="display: flex; align-items: center; justify-content: center; width: 100%;"> <!-- å±…ä¸­è£å‰ªæŒ‰éˆ• -->
      <button id="cropBtn">è£å‰ªåœ–ç‰‡</button>
    </div>
    <div>
      <img id="image" style="max-width: 100%; display: none;">
    </div>

    <h3>è£å‰ªçµæœï¼š</h3>

    <button id="clearBtn">å…¨éƒ¨æ¸…é™¤</button>

    <div class="slider-container">
      <label for="scaleSlider">è£åˆ‡å€å¤§å° (px)</label> <!-- ä¿®æ”¹ Label æ–‡å­— -->
      <input type="range" id="scaleSlider" min="50" max="1000" step="10" value="320">
       <span id="scaleValue" style="font-size: 14px; color: #555;">320</span> <!-- é¡¯ç¤ºæ•¸å€¼ -->
    </div>

    <div id="preview">
      <!-- è£å‰ªçµæœå°‡åœ¨é€™è£¡é¡¯ç¤º -->
    </div>

    <div style="
      margin-top: 30px;
      padding: 15px;
      background-color: #f5f5f5; /* æ·ºç°è‰²èƒŒæ™¯ */
      border-radius: 8px;
      color: #333;
      font-size: 15px;
      line-height: 1.6;
      border: 1px solid #eee; /* éå¸¸æ·ºçš„é‚Šæ¡† */
    ">
      <strong>ç”¨ GPT åš LINE è²¼åœ–ï¼Ÿè£åˆ‡å·¥å…·æ‰æ˜¯é—œéµï¼</strong><br><br>
      GPTç”¢åœ–è¶…æ–¹ä¾¿ï¼Œä¸€å¥ã€Œç”Ÿæˆä¹å®®æ ¼è²¼åœ–ã€å°±èƒ½æå®šã€‚ä½†å¸¸å¸¸åœ–æ¡ˆä½ç½®æœƒåï¼Œç„¡æ³•ç›´æ¥ä½¿ç”¨ã€‚<br><br>
      ğŸ”§ <strong>ç‰¹è‰²ç°¡ä»‹ï¼š</strong><br>
      è‡ªå‹•ä¹å®®æ ¼è£åˆ‡æ¡†<br>
      æ”¯æ´æ‹–æ›³èˆ‡ç¸®æ”¾ï¼Œè‡ªç”±èª¿æ•´<br>
      æ‰‹æ©Ÿæ“ä½œä¹Ÿæ–¹ä¾¿ï¼Œæ»‘æ¢è¼•é¬†å¾®èª¿<br>
      ä¸€éµè£åˆ‡ï¼Œç«‹å³é è¦½èˆ‡ä¸‹è¼‰<br><br>
      æ”¯æ´æ‰€æœ‰ AI ç”Ÿæˆåœ–ï¼Œåªè¦ä¸Šå‚³åœ–ç‰‡ï¼Œé¦¬ä¸Šæ•´ç†å‡º 9 å¼µç¬¦åˆ LINE è¦æ ¼çš„è²¼åœ–ï¼Œæ•ˆç‡æ»¿åˆ†ï¼<br><br>
      è£å¥½å¾Œé‚„èƒ½ç”¨ Canva åŠ å­—ï¼Œæˆ–åŒ¯å…¥ LINE è²¼åœ– App ç·¨è¼¯ï¼Œæ•´å€‹æµç¨‹è¶…é †æ‰‹ï¼
    </div>

    <a href="https://drive.google.com/file/d/19ERSRPrJbUP3rgLil2B9uUQYvNvsN4vC/view?usp=drive_link" target="_blank">
      åœ–ç‰‡ç¸®å°320Ã—320 ä¸‹è¼‰
    </a>
    <a href="https://www.canva.com/join/wnl-zmy-bwn" target="_blank" style=" margin-top: 10px;"> <!-- ä¿ç•™ margin-top -->
      å‰å¾€ Canva ç·¨è¼¯è²¼åœ–
    </a>

  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
  <script>
    let cropper;
    const image = document.getElementById('image');
    const upload = document.getElementById('upload');
    const cropBtn = document.getElementById('cropBtn');
    const preview = document.getElementById('preview');
    const countDisplay = document.getElementById('countDisplay');
    const clearBtn = document.getElementById('clearBtn'); // ç²å–æ¸…é™¤æŒ‰éˆ•
    const scaleSlider = document.getElementById('scaleSlider'); // ç²å–æ»‘å¡Š
    const scaleValueSpan = document.getElementById('scaleValue'); // ç²å–é¡¯ç¤ºæ•¸å€¼çš„ span

    let count = 0;

    // è™•ç†æª”æ¡ˆä¸Šå‚³
    upload.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = function(event) {
        image.src = event.target.result;
        image.style.display = 'block'; // é¡¯ç¤ºåœ–ç‰‡

        if (cropper) {
            cropper.destroy(); // å¦‚æœå·²ç¶“æœ‰ cropper å¯¦ä¾‹ï¼Œå…ˆéŠ·æ¯€å®ƒ
        }

        // åˆå§‹åŒ– Cropper.js
        cropper = new Cropper(image, {
          viewMode: 1, // æŸ¥çœ‹æ¨¡å¼ï¼Œ1 è¡¨ç¤ºé™åˆ¶è£å‰ªæ¡†åœ¨åœ–ç‰‡ç¯„åœå…§
          dragMode: 'move', // æ‹–æ›³æ¨¡å¼ï¼Œmove å…è¨±ç§»å‹•åœ–ç‰‡
          zoomable: true, // å…è¨±ç¸®æ”¾
          scalable: false, // ä¸å…è¨±æ°´å¹³æˆ–å‚ç›´ç¸®æ”¾
          rotatable: false, // ä¸å…è¨±æ—‹è½‰
          cropBoxMovable: true, // å…è¨±ç§»å‹•è£å‰ªæ¡†
          cropBoxResizable: true, // å…è¨±èª¿æ•´è£å‰ªæ¡†å¤§å°
          minCropBoxWidth: 50, // æœ€å°è£å‰ªæ¡†å¯¬åº¦
          minCropBoxHeight: 50, // æœ€å°è£å‰ªæ¡†é«˜åº¦
          aspectRatio: 1, // è¨­ç½®è£å‰ªæ¡†æ¯”ä¾‹ç‚º 1:1
          ready() {
            // åˆå§‹åŒ–è£å‰ªæ¡†å¤§å°
             const initialSize = parseInt(scaleSlider.value);
             cropper.setCropBoxData({ width: initialSize, height: initialSize });
             scaleValueSpan.textContent = initialSize; // åˆå§‹åŒ–é¡¯ç¤ºæ•¸å€¼
          },
           cropmove: function(event) {
              // å¯é¸ï¼šå¦‚æœè£å‰ªæ¡†å¤§å°è®ŠåŒ–æ™‚éœ€è¦æ›´æ–°æ»‘å¡Šå€¼
              const cropBoxData = cropper.getCropBoxData();
              const size = Math.round(cropBoxData.width); // å‡è¨­å¯¬é«˜ç›¸ç­‰
               // é˜²æ­¢æ»‘å¡Šè¶…å‡ºç¯„åœå°è‡´éŒ¯èª¤
               if (size >= parseInt(scaleSlider.min) && size <= parseInt(scaleSlider.max)) {
                   scaleSlider.value = size;
                   scaleValueSpan.textContent = size;
               }
           }
        });

        cropBtn.style.display = 'block'; // é¡¯ç¤ºè£å‰ªæŒ‰éˆ•
      };
      reader.readAsDataURL(file); // å°‡åœ–ç‰‡è®€å–ç‚º Data URL
    });

    // è™•ç†è£å‰ªæŒ‰éˆ•é»æ“Š
    cropBtn.addEventListener('click', function() {
      if (!cropper) return; // å¦‚æœæ²’æœ‰ cropper å¯¦ä¾‹ï¼Œä¸åŸ·è¡Œ

      // ç²å–è£å‰ªå¾Œçš„ canvas
      const originalCanvas = cropper.getCroppedCanvas();

      // å¦‚æœéœ€è¦ç¸®å°åœ–ç‰‡ï¼Œå¯ä»¥åœ¨é€™è£¡èª¿æ•´å¤§å°
      // ä¾‹å¦‚ï¼Œå›ºå®šè¼¸å‡ºç‚º 320x320:
      const targetSize = 320;
      const scaledCanvas = document.createElement('canvas');
      scaledCanvas.width = targetSize;
      scaledCanvas.height = targetSize;
      const ctx = scaledCanvas.getContext('2d');
      // å°‡åŸå§‹è£å‰ªçµæœç¹ªè£½åˆ°æ–°çš„ canvas ä¸Šï¼Œä¸¦ç¸®æ”¾åˆ°ç›®æ¨™å¤§å°
      ctx.drawImage(originalCanvas, 0, 0, targetSize, targetSize);


      // å‰µå»ºä¸€å€‹ div ä¾†åŒ…å« Canvas å’Œä¸‹è¼‰æŒ‰éˆ•
      const block = document.createElement('div');
      block.className = 'preview-block';
      block.appendChild(scaledCanvas); // å°‡ç¸®å°å¾Œçš„ canvas æ·»åŠ åˆ° block

      // å°‡ canvas è½‰æ›ç‚º Blobï¼Œç„¶å¾Œå‰µå»ºä¸‹è¼‰é€£çµ
      scaledCanvas.toBlob(function(blob) {
        const link = document.createElement('a');
        link.className = 'downloadBtn';
        count++; // è²¼åœ–æ•¸é‡åŠ ä¸€
        // è¨­ç½®ä¸‹è¼‰æª”æ¡ˆåç¨±ï¼Œå¯ä»¥åŠ ä¸Šç·¨è™Ÿ
        link.download = `sticker_${count}.png`;
        link.textContent = 'â¬‡ ä¸‹è¼‰'; // ä¸‹è¼‰æŒ‰éˆ•æ–‡å­—
        link.href = URL.createObjectURL(blob); // å‰µå»º Blob URL ä½œç‚ºä¸‹è¼‰é€£çµ
        block.appendChild(link); // å°‡ä¸‹è¼‰é€£çµæ·»åŠ åˆ° block
        preview.appendChild(block); // å°‡æ•´å€‹ block æ·»åŠ åˆ°é è¦½å€

        // æ›´æ–°è²¼åœ–æ•¸é‡é¡¯ç¤º
        countDisplay.textContent = `ç›®å‰è£åˆ‡å¼µæ•¸ï¼š${count}`;

        // é‡‹æ”¾ Blob URL (ä¸‹è¼‰å¾Œæœƒè‡ªå‹•é‡‹æ”¾ï¼Œä½†æ—©é»é‡‹æ”¾æ›´å¥½)
        // URL.revokeObjectURL(link.href); // æ³¨æ„ï¼šé€™è¡Œå¯èƒ½æœƒå°è‡´ä¸€äº›ç€è¦½å™¨ç«‹å³åœæ­¢ä¸‹è¼‰ï¼Œæœ€å¥½ä¸è¦åŠ 
      }, 'image/png', 1); // è¼¸å‡ºç‚º PNG æ ¼å¼ï¼Œè³ªé‡ 1 (æœ€é«˜)
    });

    // æ¸…é™¤æ‰€æœ‰è£å‰ªçµæœ
    clearBtn.addEventListener('click', function () {
      preview.innerHTML = ''; // æ¸…ç©ºé è¦½å€çš„å…§å®¹
      count = 0; // é‡ç½®è¨ˆæ•¸
      countDisplay.textContent = 'ç›®å‰è£åˆ‡å¼µæ•¸ï¼š0'; // æ›´æ–°é¡¯ç¤º
    });

    // è™•ç†æ»‘å¡Šè®ŠåŒ–ï¼Œèª¿æ•´è£å‰ªæ¡†å¤§å°
    scaleSlider.addEventListener('input', function () {
      const size = parseInt(scaleSlider.value);
      scaleValueSpan.textContent = size; // æ›´æ–°é¡¯ç¤ºæ•¸å€¼
      if (cropper) {
        // è¨­ç½®è£å‰ªæ¡†çš„å¤§å°ï¼ŒåŒæ™‚ä¿æŒä¸­å¿ƒä½ç½®ä¸è®Šï¼ˆ Cropper.js é»˜èªè¡Œç‚ºï¼‰
        cropper.setCropBoxData({ width: size, height: size });
      }
    });
  </script>
</body>
</html>
